CREATE TABLE CONSTITUENCY( 

CONSTID INT PRIMARY KEY, 

NAME VARCHAR(30),

STATE VARCHAR(30), 

NOOFVOTERS INT

);

INSERT INTO CONSTITUENCY 

VALUES(1,'BANGALORE','KARNATAKA',2); INSERT INTO 

CONSTITUENCY VALUES(2,'SHIMOGA','KARNATAKA',2); INSERT

INTO CONSTITUENCY VALUES(3,'HYDARABAD','TELANGANA',3);


CREATE TABLE PARTY( 

PID INT PRIMARY KEY, 

PNAME VARCHAR(30), 

SYMBOL VARCHAR(30));

INSERT INTO PARTY VALUES(1,'CONGRESS','PALM'); 

INSERT INTOPARTY VALUES(2,'BJP','LOTUS');

CREATE TABLE CANDIDATE( 

CANDID INT PRIMARY KEY, 

NAME VARCHAR(30), 

PNO VARCHAR(30),

AGE INT,

STATE VARCHAR(30),

PID INT REFERENCES PARTY(PID)

);

INSERT INTO CANDIDATE VALUES(1,'AMAR','8660639260',35,'KARNATAKA',1); 

INSERT INTO CANDIDATE VALUES(2,'ANTONY','8660639262',37,'TELANGANA',2);


CREATE TABLE VOTERS( 

VID INT,

NAME VARCHAR(30), 

AGE VARCHAR(30), 

ADDRESS VARCHAR(150),

CONSTID INT REFERENCES CONSTITUENCY(CONSTID), 

CANDID INT REFERENCES CANDIDATE(CANDID));

INSERT INTO VOTERS VALUES(1,'ABHI',20,'1 BALKI BIDAR KARNATAKA 577001',1,1); 

INSERT INTO VOTERS VALUES(2,'ARIF',20,'1 BHADRAVATHI BHADRAVATHI 

KARNATAKA 577201',2,2);

INSERT INTO VOTERS VALUES(3,'MANOJ',18,'1 ANAVERI SHIMOGA KARNATAKA 577243',1,2);

CREATE TABLE CONTEST(

CONSTID INT REFERENCES CONSTITUENCY(CONSTID), 

CANDID INT REFERENCES CANDIDATE(CANDID)

INSERT INTO CONTEST VALUES(1,1); 

INSERT INTO CONTEST VALUES(2,2); 

INSERT INTO CONTEST VALUES(3,1);





1) SELECT *

FROM CANDIDATE 

WHERE CANDID IN (

SELECT CANDID

FROM CONTEST CT, CONSTITUENCY CS 

WHERE CT.CONSTID = CS.CONSTID 

GROUP BY CANDID

HAVING COUNT(DISTINCT(STATE))>1);

2)SELECT STATE FROM CONSTITUENCY 

GROUP BY STATE

HAVING COUNT(STATE) =

(SELECT MAX(COUNTS) FROM (

COUNT(*) COUNTS 

FROM CONSTITUENCY

GROUP BY STATE) COUNTER);

3) CREATE OR REPLACE PROCEDURE CHECKAGE(ID IN NUMBER,AGE IN NUMBER) 

AS

BEGIN

IF AGE>=18 THEN

INSERT INTO VOTERS(VID,AGE)VALUES(ID,AGE); 

ELSE

DBMS_OUTPUT.PUT_LINE('NOT AN ELIGIBLE VOTER'); 

END IF;

END;

BEGIN

CHECKAGE(17);

END;

NOT AN ELIGIBLE VOTER

4) CREATE OR REPLACE PROCEDURE COUNTVOTERS(ID INNUMBER) 

AS

CNT CONSTITUENCY.CONSTID % TYPE;

BEGIN

SELECT NOOFVOTERS INTO CNT 

FROM CONSTITUENCY

WHERE CONSTID = ID AND ROWNUM = 1; 

DBMS_OUTPUT.PUT_LINE ( 'TOTAL VOTERS ARE: ' || CNT);
END;
/

BEGIN

COUNTVOTERS (1);

END;

5)CREATE OR REPLACE TRIGGER UPDATECOUNT 

AFTER INSERT ON VOTERS

FOR EACH ROW 

BEGIN

UPDATE CONSTITUENCY

SET NOOFVOTERS = NOOFVOTERS + 1 

WHERE CONSTID=:NEW.CONSTID; 

END;
/

Trigger created.

INSERT INTO VOTERS VALUES(10,'ARUN',22,'1 BALKI BIDAR KARNATAKA 577002',1,1);
