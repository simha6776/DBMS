CREATE TABLE TEAM( 

TEAMID INT PRIMARY KEY, 

TNAME VARCHAR(30), 

CITY VARCHAR(30), 

COACH VARCHAR(30), 

CID INT

);

INSERT INTO TEAM VALUES

(1,'RCB','BANGALORE','RAHUL',1); INSERT INTO TEAM

VALUES (2,'CSK','CHENNAI','AKBAR',2); INSERT INTO TEAM

VALUES (3,'MI','MUMBAI','ANTONY',3); INSERT INTO TEAM 

VALUES (4,'GT','GUJARAT','RAHUL DRAVID',4);

CREATE TABLE PLAYER( 

PID INT PRIMARY KEY, 

PNAME VARCHAR(30), 

AGE INT,

TEAMID INT REFERENCES TEAM(TEAMID)

);


CREATE TABLE PLAYER( 

PID INT PRIMARY KEY, 

PNAME VARCHAR(30), 

AGE INT,

TEAMID INT REFERENCES TEAM(TEAMID));

INSERT INTO PLAYER VALUES (1,'VIRAT',35,1);

INSERT INTO PLAYER VALUES (2,'DHONI',40,2); 

INSERT INTO PLAYER VALUES (3,'ROHITH',39,3); 

INSERT INTO PLAYER VALUES (4,'HARDIK',30,4); 

INSERT INTO PLAYER VALUES (5,'K L RAHUL',32,1);


ALTER TABLE TEAM

ADD FOREIGN KEY (CID) REFERENCES PLAYER(PID);


CREATE TABLE PHONE(

PID INT REFERENCES PLAYER(PID), 

PHONE VARCHAR(20)

);

INSERT INTO PHONE VALUES (1,'9999999999'); 

INSERT INTO PHONE VALUES (2,'9999999998'); 

INSERT INTO PHONE VALUES (3,'9999999997'); 

INSERT INTO PHONE VALUES (4,'9999999996'); 

INSERT INTO PHONE VALUES (5,'9999999995'); 

INSERT INTO PHONE VALUES (1,'9999999994');

CREATE TABLE STADIUM( 

SID INT PRIMARY KEY, 

SNAME VARCHAR(30), 

CITY VARCHAR(30), 

AREA VARCHAR(30), 

PINCODE INT

);

 INSERT INTO STADIUM VALUES(1,'CHINNASWAMY','BANGALORE','MG ROAD','560092');

INSERT INTO STADIUM VALUES(2,'KANTEERAVA','DELHI','MAIN 

ROAD','560093'); 

INSERT INTO STADIUM VALUES(3,'MODI','GUJARAT','CITY','560094');

CREATE TABLE MATCH( 

MID INT PRIMARY KEY,

TEAM1ID INT REFERENCES TEAM(TEAMID), 

TEAM2ID INT REFERENCES TEAM(TEAMID), 

WINNERID INT REFERENCES TEAM(TEAMID), 

MOTMATCH INT REFERENCES PLAYER(PID), 

MTIME VARCHAR(10),

MDATE DATE,

MSTADIUM INT REFERENCES STADIUM(SID));

INSERT INTO MATCH VALUES(1,1,2,1,1,'7PM','12-01-23',1);

INSERT INTO MATCH VALUES(2,1,3,1,1,'7PM','13-01-23',3);

INSERT INTO MATCH VALUES(3,1,4,1,5,'7PM','14-01-23',1);

INSERT INTO MATCH VALUES(4,4,2,2,2,'7PM','15-01-23',2);

INSERT INTO MATCH VALUES(5,1,2,1,5,'7PM','16-01-23',1);


1)SELECT PNAME, TNAME, AGE 

FROM PLAYER P, TEAM T

WHERE P.TEAMID = T.TEAMID AND AGE = (SELECT MIN(AGE) FROM PLAYER);

2)SELECT * 

FROM STADIUM 

WHERE SID IN (

SELECT MSTADIUM 

FROM MATCH 

GROUP BY MSTADIUM

HAVING COUNT(MSTADIUM) = ( 

SELECT MAX(COUNTS) FROM ( 

SELECT COUNT(*) COUNTS

FROM MATCH

GROUP BY MSTADIUM) COUNTER

)

);


3) SELECT * 

FROM PLAYER 

WHERE PID IN (

SELECT MOTMATCH 

FROM MATCH

GROUP BY MOTMATCH

HAVING COUNT(MOTMATCH)>=2

) AND PID NOT IN (SELECT CID FROM TEAM);


4) SELECT * 

FROM TEAM

WHERE TEAMID IN ( 

SELECT WINNERID 

FROM MATCH

GROUP BY WINNERID

HAVING COUNT(WINNERID) = ( 

SELECT MAX(COUNTS) FROM(

SELECT COUNT(*) COUNTS 

FROM MATCH

GROUP BY WINNERID) COUNTER

)

);


5)SELECT TNAME 

FROM TEAM, MATCH

WHERE TEAMID = WINNERID 

GROUP BY TNAME

HAVING COUNT(DISTINCT MSTADIUM) = 1;
