
CREATE TABLE TOURIST (
);
TID INT PRIMARY KEY, NAME VARCHAR(30), AGE INT,
COUNTRY VARCHAR(30)
INSERT INTO TOURIST VALUES(1,'AMAR',21,'INDIA'); INSERT INTO TOURIST VALUE(2, 'AKBAR',22, 'INDIA'); INSERT INTO TOURIST VALUES (3,'ANTONY',20,'UK'); INSERT INTO TOURIST VALUES (4,'RAM',25,'US');
CREATE TABLE EMAIL(
);
TOURISTID INT REFERENCES TOURIST(TID), EMAIL VARCHAR(50)
INSERT INTO EMAIL VALUES(1,'AMAR@GMAIL.COM'); INSERT INTO EMAIL VALUES(1,'AMAR.P@GMAIL.COM'); INSERT INTO EMAIL VALUES (2,' AKBARAMAR@GMAIL.COM'); INSERT INTO EMAIL VALUES (3,'ANTONY@GMAIL.COM'); INSERT INTO EMAIL VALUES(4,'RAM@GMAIL.COM');
CREATE TABLE PLACE( PID INT PRIMARY KEY, NAME VARCHAR(50),
);
STATE VARCHAR(50), KM INT,
HISTORY VARCHAR(200)
INSERT INTO PLACE VALUES(1,'JOG FALSE','KARNATAKA, 400, WATER FALSE');
INSERT INTO PLACE VALUES (2, 'MYSORE, KARNATAKA',150, 'PALACE'); INSERT INTO PLACE VALUES(3, TAJMAHAL', 'DELHI',100,'BURIAL');
INSERT INTO PLACE VALUES(4, TIRUPATHI', 'AP',50, TEMPLE');
Dept. of CSE, VTU CPGS, MYSURU
24


DBMS LAB MANUAL
CREATE TABLE VISIT(
);
TID INT REFERENCES TOURIST(TID),
PID INT REFERENCES PLACE(PID), VISITDATE DATE
INSERT INTO VISIT VALUES(1,1,'12-1-2022'); INSERT INTO VISIT VALUES(2,1,'12-1-2022'); INSERT INTO VISIT VALUES(3,1,'12-1-2022');
INSERT INTO VISIT VALUES(4,1,'12-1-2022'); INSERT INTO VISIT VALUES(2,2, '12-1-2022'); INSERT INTO VISIT VALUES(2,3,'12-1-2022'); INSERT INTO VISIT VALUES(2,4,'12-1-2022');
i. List the state name which is having maximum number of tourist places.
SELECT STATE
FROM PLACE
GROUP BY STATE
HAVING COUNT(*) = (
SELECT MAX(COUNTS) FROM(
SELECT COUNT(*) COUNTS
FROM PLACE
GROUP BY STATE) COUNTER
);
STATE
KARNATAKA
MMCL106


DBMS LAB MANUAL
MMCL106
iv. Display the details of the tourists visited at least one tourist place of the state, but visited all states tourist places.
SELECT T.NAME, AGE, COUNTRY
FROM VISIT V, PLACE P, TOURIST T WHERE V.PID = P.PID AND V.TID = T.TID GROUP BY T.NAME, AGE, COUNTRY HAVING COUNT(DISTINCT STATE) = ( SELECT COUNT(DISTINCT STATE) FROM PLACE
);
NAME AGE COUNTRY
AKBAR 22 INDIA
v. Display the details of the tourist place visited by the tourists of all country
SELECT P.NAME, KM, HISTORY
FROM VISIT V, PLACE P, TOURIST T
WHERE V.PID = P.PID AND V.TID = T.TID
GROUP BY P.NAME, KM, HISTORY HAVING COUNT(DISTINCT COUNTRY) = ( SELECT COUNT(DISTINCT COUNTRY) FROM TOURIST
);
NAME KM HISTORY
JOG FALSE 400 WATER FALSE
